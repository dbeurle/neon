
#include "cowper.hpp"

#include <algorithm>

namespace neon::quadrature::triangle
{
cowper::cowper(int const minimum_degree)
{
    switch (minimum_degree)
    {
        case 1:
        case 2:
        {
            m_degree = 2;
            m_weights = {0.3333333333333333, 0.3333333333333333, 0.3333333333333333};
            m_coordinates = {{0, 0.16666666666666666, 0.6666666666666667},
                             {1, 0.6666666666666667, 0.16666666666666666},
                             {2, 0.16666666666666666, 0.16666666666666666}};
            break;
        }
        case 3:
        {
            m_degree = 3;
            m_weights = {0.16666666666666666,
                         0.16666666666666666,
                         0.16666666666666666,
                         0.16666666666666666,
                         0.16666666666666666,
                         0.16666666666666666};
            m_coordinates = {{0, 0.231933368553031, 0.10903900907287703},
                             {1, 0.659027622374092, 0.231933368553031},
                             {2, 0.10903900907287703, 0.659027622374092},
                             {3, 0.659027622374092, 0.10903900907287703},
                             {4, 0.231933368553031, 0.659027622374092},
                             {5, 0.10903900907287703, 0.231933368553031}};
            break;
        }
        case 4:
        {
            m_degree = 4;
            m_weights = {0.109951743655322,
                         0.223381589678011,
                         0.109951743655322,
                         0.223381589678011,
                         0.109951743655322,
                         0.223381589678011};
            m_coordinates = {{0, 0.091576213509771, 0.816847572980458},
                             {1, 0.445948490915965, 0.10810301816807},
                             {2, 0.816847572980458, 0.091576213509771},
                             {3, 0.10810301816807, 0.445948490915965},
                             {4, 0.091576213509771, 0.091576213509771},
                             {5, 0.445948490915965, 0.445948490915965}};
            break;
        }
        case 5:
        {
            m_degree = 5;
            m_weights = {0.205950504760887,
                         0.205950504760887,
                         0.205950504760887,
                         0.063691414286223,
                         0.063691414286223,
                         0.063691414286223,
                         0.063691414286223,
                         0.063691414286223,
                         0.063691414286223};
            m_coordinates = {{0, 0.437525248383384, 0.12494950323323195},
                             {1, 0.12494950323323195, 0.437525248383384},
                             {2, 0.437525248383384, 0.437525248383384},
                             {3, 0.165409927389841, 0.03747742075008803},
                             {4, 0.797112651860071, 0.165409927389841},
                             {5, 0.03747742075008803, 0.797112651860071},
                             {6, 0.797112651860071, 0.03747742075008803},
                             {7, 0.165409927389841, 0.797112651860071},
                             {8, 0.03747742075008803, 0.165409927389841}};
            break;
        }
        case 6:
        {
            m_degree = 6;
            m_weights = {0.050844906370207,
                         0.116786275726379,
                         0.050844906370207,
                         0.116786275726379,
                         0.050844906370207,
                         0.116786275726379,
                         0.082851075618374,
                         0.082851075618374,
                         0.082851075618374,
                         0.082851075618374,
                         0.082851075618374,
                         0.082851075618374};
            m_coordinates = {{0, 0.063089014491502, 0.873821971016996},
                             {1, 0.24928674517091, 0.50142650965818},
                             {2, 0.873821971016996, 0.063089014491502},
                             {3, 0.50142650965818, 0.24928674517091},
                             {4, 0.063089014491502, 0.063089014491502},
                             {5, 0.24928674517091, 0.24928674517091},
                             {6, 0.310352451033785, 0.053145049844815995},
                             {7, 0.636502499121399, 0.310352451033785},
                             {8, 0.053145049844815995, 0.636502499121399},
                             {9, 0.636502499121399, 0.053145049844815995},
                             {10, 0.310352451033785, 0.636502499121399},
                             {11, 0.053145049844815995, 0.310352451033785}};
            break;
        }
        case 7:
        {
            m_degree = 7;
            m_weights = {-0.14957004446767,
                         0.175615257433204,
                         0.053347235608839,
                         0.175615257433204,
                         0.053347235608839,
                         0.175615257433204,
                         0.053347235608839,
                         0.077113760890257,
                         0.077113760890257,
                         0.077113760890257,
                         0.077113760890257,
                         0.077113760890257,
                         0.077113760890257};
            m_coordinates = {{0, 0.3333333333333333, 0.3333333333333333},
                             {1, 0.260345966079038, 0.47930806784192403},
                             {2, 0.065130102902216, 0.869739794195568},
                             {3, 0.47930806784192403, 0.260345966079038},
                             {4, 0.869739794195568, 0.065130102902216},
                             {5, 0.260345966079038, 0.260345966079038},
                             {6, 0.065130102902216, 0.065130102902216},
                             {7, 0.312865496004875, 0.04869031542531599},
                             {8, 0.638444188569809, 0.312865496004875},
                             {9, 0.04869031542531599, 0.638444188569809},
                             {10, 0.638444188569809, 0.04869031542531599},
                             {11, 0.312865496004875, 0.638444188569809},
                             {12, 0.04869031542531599, 0.312865496004875}};
            break;
        }
    }
    std::transform(begin(m_weights), end(m_weights), begin(m_weights), [](auto const weight) {
        return 0.5 * weight;
    });
}
}
